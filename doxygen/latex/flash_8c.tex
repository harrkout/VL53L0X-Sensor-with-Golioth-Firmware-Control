\doxysection{src/flash.c File Reference}
\hypertarget{flash_8c}{}\label{flash_8c}\index{src/flash.c@{src/flash.c}}


Golioth Device Firmware Update (DFU) module.  


{\ttfamily \#include $<$logging/log.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$storage/flash\+\_\+map.\+h$>$}\newline
{\ttfamily \#include "{}flash.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{flash_8c_a2ed7fec39158370596f625073bbe0103}{FLASH\+\_\+\+AREA\+\_\+\+IMAGE\+\_\+\+PRIMARY}}~FLASH\+\_\+\+AREA\+\_\+\+ID(image\+\_\+0)
\item 
\#define \mbox{\hyperlink{flash_8c_a12997948779826d0057aae6325d52f18}{ERASED\+\_\+\+VAL\+\_\+32}}(x)~(((x) $<$$<$ 24) \texorpdfstring{$\vert$}{|} ((x) $<$$<$ 16) \texorpdfstring{$\vert$}{|} ((x) $<$$<$ 8) \texorpdfstring{$\vert$}{|} (x))
\begin{DoxyCompactList}\small\item\em Macro to create a 32-\/bit value with all bytes set to a given value. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{flash_8c_af501c251e4f8f8d1f7868d3f4efe2439}{LOG\+\_\+\+MODULE\+\_\+\+DECLARE}} (golioth\+\_\+dfu)
\item 
\mbox{\hyperlink{flash_8c_a0194512766067ccdb808e494fb5234c2}{SYS\+\_\+\+INIT}} (current\+\_\+version\+\_\+init, APPLICATION, CONFIG\+\_\+\+APPLICATION\+\_\+\+INIT\+\_\+\+PRIORITY)
\item 
int \mbox{\hyperlink{flash_8c_a62677ad18a8efbfd7867fcbb060f50a9}{flash\+\_\+img\+\_\+prepare}} (struct \mbox{\hyperlink{structflash__img__context}{flash\+\_\+img\+\_\+context}} \texorpdfstring{$\ast$}{*}flash)
\begin{DoxyCompactList}\small\item\em Prepares the flash image for an update. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char \mbox{\hyperlink{flash_8c_a1ac73c01498e899b01a94c526d147585}{current\+\_\+version\+\_\+str}} \mbox{[}sizeof("{}255.\+255.\+65535"{})\mbox{]}
\begin{DoxyCompactList}\small\item\em String to store the current firmware version. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Golioth Device Firmware Update (DFU) module. 



Definition in file \mbox{\hyperlink{flash_8c_source}{flash.\+c}}.



\doxysubsection{Macro Definition Documentation}
\Hypertarget{flash_8c_a12997948779826d0057aae6325d52f18}\label{flash_8c_a12997948779826d0057aae6325d52f18} 
\index{flash.c@{flash.c}!ERASED\_VAL\_32@{ERASED\_VAL\_32}}
\index{ERASED\_VAL\_32@{ERASED\_VAL\_32}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{ERASED\_VAL\_32}{ERASED\_VAL\_32}}
{\footnotesize\ttfamily \#define ERASED\+\_\+\+VAL\+\_\+32(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(((x) $<$$<$ 24) \texorpdfstring{$\vert$}{|} ((x) $<$$<$ 16) \texorpdfstring{$\vert$}{|} ((x) $<$$<$ 8) \texorpdfstring{$\vert$}{|} (x))}



Macro to create a 32-\/bit value with all bytes set to a given value. 



Definition at line \mbox{\hyperlink{flash_8c_source_l00074}{74}} of file \mbox{\hyperlink{flash_8c_source}{flash.\+c}}.

\Hypertarget{flash_8c_a2ed7fec39158370596f625073bbe0103}\label{flash_8c_a2ed7fec39158370596f625073bbe0103} 
\index{flash.c@{flash.c}!FLASH\_AREA\_IMAGE\_PRIMARY@{FLASH\_AREA\_IMAGE\_PRIMARY}}
\index{FLASH\_AREA\_IMAGE\_PRIMARY@{FLASH\_AREA\_IMAGE\_PRIMARY}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{FLASH\_AREA\_IMAGE\_PRIMARY}{FLASH\_AREA\_IMAGE\_PRIMARY}}
{\footnotesize\ttfamily \#define FLASH\+\_\+\+AREA\+\_\+\+IMAGE\+\_\+\+PRIMARY~FLASH\+\_\+\+AREA\+\_\+\+ID(image\+\_\+0)}



Definition at line \mbox{\hyperlink{flash_8c_source_l00025}{25}} of file \mbox{\hyperlink{flash_8c_source}{flash.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{flash_8c_a62677ad18a8efbfd7867fcbb060f50a9}\label{flash_8c_a62677ad18a8efbfd7867fcbb060f50a9} 
\index{flash.c@{flash.c}!flash\_img\_prepare@{flash\_img\_prepare}}
\index{flash\_img\_prepare@{flash\_img\_prepare}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{flash\_img\_prepare()}{flash\_img\_prepare()}}
{\footnotesize\ttfamily int flash\+\_\+img\+\_\+prepare (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structflash__img__context}{flash\+\_\+img\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{flash }\end{DoxyParamCaption})}



Prepares the flash image for an update. 


\begin{DoxyParams}{Parameters}
{\em flash} & Flash image context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, negative error code on failure 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{flash_8c_source_l00190}{190}} of file \mbox{\hyperlink{flash_8c_source}{flash.\+c}}.

\Hypertarget{flash_8c_af501c251e4f8f8d1f7868d3f4efe2439}\label{flash_8c_af501c251e4f8f8d1f7868d3f4efe2439} 
\index{flash.c@{flash.c}!LOG\_MODULE\_DECLARE@{LOG\_MODULE\_DECLARE}}
\index{LOG\_MODULE\_DECLARE@{LOG\_MODULE\_DECLARE}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{LOG\_MODULE\_DECLARE()}{LOG\_MODULE\_DECLARE()}}
{\footnotesize\ttfamily LOG\+\_\+\+MODULE\+\_\+\+DECLARE (\begin{DoxyParamCaption}\item[{golioth\+\_\+dfu}]{ }\end{DoxyParamCaption})}

\Hypertarget{flash_8c_a0194512766067ccdb808e494fb5234c2}\label{flash_8c_a0194512766067ccdb808e494fb5234c2} 
\index{flash.c@{flash.c}!SYS\_INIT@{SYS\_INIT}}
\index{SYS\_INIT@{SYS\_INIT}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{SYS\_INIT()}{SYS\_INIT()}}
{\footnotesize\ttfamily SYS\+\_\+\+INIT (\begin{DoxyParamCaption}\item[{current\+\_\+version\+\_\+init}]{,  }\item[{APPLICATION}]{,  }\item[{CONFIG\+\_\+\+APPLICATION\+\_\+\+INIT\+\_\+\+PRIORITY}]{ }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\Hypertarget{flash_8c_a1ac73c01498e899b01a94c526d147585}\label{flash_8c_a1ac73c01498e899b01a94c526d147585} 
\index{flash.c@{flash.c}!current\_version\_str@{current\_version\_str}}
\index{current\_version\_str@{current\_version\_str}!flash.c@{flash.c}}
\doxysubsubsection{\texorpdfstring{current\_version\_str}{current\_version\_str}}
{\footnotesize\ttfamily char current\+\_\+version\+\_\+str\mbox{[}sizeof("{}255.\+255.\+65535"{})\mbox{]}}



String to store the current firmware version. 



Definition at line \mbox{\hyperlink{flash_8c_source_l00034}{34}} of file \mbox{\hyperlink{flash_8c_source}{flash.\+c}}.

